#!/bin/sh
# Copyright (C) 2006 OpenWrt.org

DEV=${DEVPATH##*/}
{
case "$ACTION" in
add)
	echo -ne "waiting for $DEV"
	while [ ! -b /dev/$DEV ]; do {
		echo -ne "."
		sleep 1
		[ $((++time)) -gt 10 ] && break
	}; done
	echo
	
	[ ${DEV%%[0-9]} != ${DEV} -a ${DEV%%[0-9]} != "loop" ] && {
		mkdir -p /tmp/$DEV
		mount /dev/$DEV /tmp/$DEV -t auto -o sync
	}
	;;
remove)
	umount /tmp/$DEV && rm -f /dev/$DEV /tmp/$DEV
	;;
esac
} 2>&1 | logger
